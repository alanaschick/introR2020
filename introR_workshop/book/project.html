<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>10 Project | Introduction to R for Biologists</title>
  <meta name="description" content="This tutorial covers workshop material" />
  <meta name="generator" content="bookdown 0.17 and GitBook 2.6.7" />

  <meta property="og:title" content="10 Project | Introduction to R for Biologists" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This tutorial covers workshop material" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="10 Project | Introduction to R for Biologists" />
  
  <meta name="twitter:description" content="This tutorial covers workshop material" />
  

<meta name="author" content="Alana Schick" />


<meta name="date" content="2020-03-13" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="data-visualization-with-ggplot2.html"/>
<link rel="next" href="summary.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Intro R Workshop</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Welcome</a><ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#workshop-schedule"><i class="fa fa-check"></i><b>1.1</b> Workshop Schedule</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#day-1"><i class="fa fa-check"></i>Day 1</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#day-2"><i class="fa fa-check"></i>Day 2</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#important-links"><i class="fa fa-check"></i><b>1.2</b> Important links</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="pre-workshop.html"><a href="pre-workshop.html"><i class="fa fa-check"></i><b>2</b> Pre-workshop</a><ul>
<li class="chapter" data-level="2.1" data-path="pre-workshop.html"><a href="pre-workshop.html#installation"><i class="fa fa-check"></i><b>2.1</b> Installation</a><ul>
<li class="chapter" data-level="2.1.1" data-path="pre-workshop.html"><a href="pre-workshop.html#windows"><i class="fa fa-check"></i><b>2.1.1</b> Windows</a></li>
<li class="chapter" data-level="2.1.2" data-path="pre-workshop.html"><a href="pre-workshop.html#macos"><i class="fa fa-check"></i><b>2.1.2</b> MacOS</a></li>
<li class="chapter" data-level="2.1.3" data-path="pre-workshop.html"><a href="pre-workshop.html#linux"><i class="fa fa-check"></i><b>2.1.3</b> Linux</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="pre-workshop.html"><a href="pre-workshop.html#datacamp-courses"><i class="fa fa-check"></i><b>2.2</b> Datacamp Courses</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>3</b> Introduction</a><ul>
<li class="chapter" data-level="3.1" data-path="introduction.html"><a href="introduction.html#r-and-the-rstudio-ide"><i class="fa fa-check"></i><b>3.1</b> R and the RStudio IDE</a></li>
<li class="chapter" data-level="3.2" data-path="introduction.html"><a href="introduction.html#why-learn-r"><i class="fa fa-check"></i><b>3.2</b> Why learn R</a><ul>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html#r-does-not-involve-a-lot-of-pointing-and-clicking---thats-a-good-thing"><i class="fa fa-check"></i>R does not involve a lot of pointing and clicking - that’s a good thing!</a></li>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html#r-code-is-great-for-reproducibility"><i class="fa fa-check"></i>R code is great for reproducibility</a></li>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html#r-is-interdisciplinary-and-extensible"><i class="fa fa-check"></i>R is interdisciplinary and extensible</a></li>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html#r-works-on-data-of-all-shapes-and-sizes"><i class="fa fa-check"></i>R works on data of all shapes and sizes</a></li>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html#r-produces-high-quality-graphics"><i class="fa fa-check"></i>R produces high-quality graphics</a></li>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html#r-has-a-large-and-welcoming-community"><i class="fa fa-check"></i>R has a large and welcoming community</a></li>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html#interacting-with-r"><i class="fa fa-check"></i>Interacting with R</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="introduction.html"><a href="introduction.html#creating-an-rstudio-project"><i class="fa fa-check"></i><b>3.3</b> Creating an RStudio project</a></li>
<li class="chapter" data-level="3.4" data-path="introduction.html"><a href="introduction.html#creating-your-first-r-script"><i class="fa fa-check"></i><b>3.4</b> Creating your first R script</a><ul>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html#organizing-your-working-directory"><i class="fa fa-check"></i>Organizing your working directory</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="introduction.html"><a href="introduction.html#how-to-learn-more"><i class="fa fa-check"></i><b>3.5</b> How to learn more?</a><ul>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html#seeking-help"><i class="fa fa-check"></i>Seeking help</a></li>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html#i-am-stuck-i-get-an-error-message-that-i-dont-understand"><i class="fa fa-check"></i>I am stuck… I get an error message that I don’t understand</a></li>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html#asking-for-help"><i class="fa fa-check"></i>Asking for help</a></li>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html#where-to-ask-for-help"><i class="fa fa-check"></i>Where to ask for help?</a></li>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html#how-to-ask-for-r-help-useful-guidelines"><i class="fa fa-check"></i>How to ask for R help useful guidelines</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="installing-r-packages.html"><a href="installing-r-packages.html"><i class="fa fa-check"></i><b>4</b> Installing R Packages</a><ul>
<li class="chapter" data-level="4.1" data-path="installing-r-packages.html"><a href="installing-r-packages.html#what-are-r-packages"><i class="fa fa-check"></i><b>4.1</b> What are R packages?</a></li>
<li class="chapter" data-level="4.2" data-path="installing-r-packages.html"><a href="installing-r-packages.html#installing-r-packages-from-different-sources"><i class="fa fa-check"></i><b>4.2</b> Installing R packages from different sources</a><ul>
<li class="chapter" data-level="" data-path="installing-r-packages.html"><a href="installing-r-packages.html#cran"><i class="fa fa-check"></i>1. CRAN</a></li>
<li class="chapter" data-level="" data-path="installing-r-packages.html"><a href="installing-r-packages.html#bioconductor"><i class="fa fa-check"></i>2. Bioconductor</a></li>
<li class="chapter" data-level="" data-path="installing-r-packages.html"><a href="installing-r-packages.html#github"><i class="fa fa-check"></i>3. Github</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="installing-r-packages.html"><a href="installing-r-packages.html#loading-a-package"><i class="fa fa-check"></i><b>4.3</b> Loading a package</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="r-basics.html"><a href="r-basics.html"><i class="fa fa-check"></i><b>5</b> R Basics</a><ul>
<li class="chapter" data-level="5.1" data-path="r-basics.html"><a href="r-basics.html#creating-objects-in-r"><i class="fa fa-check"></i><b>5.1</b> Creating objects in R</a></li>
<li class="chapter" data-level="5.2" data-path="r-basics.html"><a href="r-basics.html#objects-vs.variables"><i class="fa fa-check"></i><b>5.2</b> Objects vs. variables</a></li>
<li class="chapter" data-level="5.3" data-path="r-basics.html"><a href="r-basics.html#comments"><i class="fa fa-check"></i><b>5.3</b> Comments</a></li>
<li class="chapter" data-level="5.4" data-path="r-basics.html"><a href="r-basics.html#functions-and-their-arguments"><i class="fa fa-check"></i><b>5.4</b> Functions and their arguments</a></li>
<li class="chapter" data-level="5.5" data-path="r-basics.html"><a href="r-basics.html#vectors"><i class="fa fa-check"></i><b>5.5</b> Vectors</a></li>
<li class="chapter" data-level="5.6" data-path="r-basics.html"><a href="r-basics.html#indexing-vectors"><i class="fa fa-check"></i><b>5.6</b> Indexing vectors</a><ul>
<li class="chapter" data-level="" data-path="r-basics.html"><a href="r-basics.html#adding-values-to-vectors"><i class="fa fa-check"></i>Adding values to vectors</a></li>
<li class="chapter" data-level="" data-path="r-basics.html"><a href="r-basics.html#replacing-values-in-existing-vectors"><i class="fa fa-check"></i>Replacing values in existing vectors</a></li>
</ul></li>
<li class="chapter" data-level="5.7" data-path="r-basics.html"><a href="r-basics.html#conditional-subsetting"><i class="fa fa-check"></i><b>5.7</b> Conditional subsetting</a></li>
<li class="chapter" data-level="5.8" data-path="r-basics.html"><a href="r-basics.html#so-we-can-use-this-to-select-only-the-values-above-50"><i class="fa fa-check"></i><b>5.8</b> so we can use this to select only the values above 50</a></li>
<li class="chapter" data-level="5.9" data-path="r-basics.html"><a href="r-basics.html#missing-data"><i class="fa fa-check"></i><b>5.9</b> Missing data</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="starting-with-data.html"><a href="starting-with-data.html"><i class="fa fa-check"></i><b>6</b> Starting with Data</a><ul>
<li class="chapter" data-level="6.1" data-path="starting-with-data.html"><a href="starting-with-data.html#download-the-data"><i class="fa fa-check"></i><b>6.1</b> Download the data</a></li>
<li class="chapter" data-level="6.2" data-path="starting-with-data.html"><a href="starting-with-data.html#csv-files"><i class="fa fa-check"></i><b>6.2</b> CSV files</a></li>
<li class="chapter" data-level="6.3" data-path="starting-with-data.html"><a href="starting-with-data.html#sidenote-importing-data-from-excel"><i class="fa fa-check"></i><b>6.3</b> Sidenote: Importing data from Excel</a></li>
<li class="chapter" data-level="6.4" data-path="starting-with-data.html"><a href="starting-with-data.html#import-data"><i class="fa fa-check"></i><b>6.4</b> Import data</a></li>
<li class="chapter" data-level="6.5" data-path="starting-with-data.html"><a href="starting-with-data.html#what-are-data-frames"><i class="fa fa-check"></i><b>6.5</b> What are data frames?</a><ul>
<li class="chapter" data-level="" data-path="starting-with-data.html"><a href="starting-with-data.html#saving-or-writing-a-data-frame"><i class="fa fa-check"></i>Saving or “writing” a data frame</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="starting-with-data.html"><a href="starting-with-data.html#what-are-factors"><i class="fa fa-check"></i><b>6.6</b> What are factors?</a><ul>
<li class="chapter" data-level="" data-path="starting-with-data.html"><a href="starting-with-data.html#the-sign"><i class="fa fa-check"></i>The $ sign</a></li>
</ul></li>
<li class="chapter" data-level="6.7" data-path="starting-with-data.html"><a href="starting-with-data.html#plotting-and-ordering-factors"><i class="fa fa-check"></i><b>6.7</b> Plotting and ordering factors</a></li>
<li class="chapter" data-level="6.8" data-path="starting-with-data.html"><a href="starting-with-data.html#subsetting-data-frames"><i class="fa fa-check"></i><b>6.8</b> Subsetting data frames</a></li>
<li class="chapter" data-level="6.9" data-path="starting-with-data.html"><a href="starting-with-data.html#other-data-types"><i class="fa fa-check"></i><b>6.9</b> Other data types</a><ul>
<li class="chapter" data-level="" data-path="starting-with-data.html"><a href="starting-with-data.html#matrices"><i class="fa fa-check"></i>Matrices</a></li>
<li class="chapter" data-level="" data-path="starting-with-data.html"><a href="starting-with-data.html#lists"><i class="fa fa-check"></i>Lists</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="conditional-statements-and-loops.html"><a href="conditional-statements-and-loops.html"><i class="fa fa-check"></i><b>7</b> Conditional Statements and Loops</a><ul>
<li class="chapter" data-level="7.1" data-path="conditional-statements-and-loops.html"><a href="conditional-statements-and-loops.html#conditional-statements"><i class="fa fa-check"></i><b>7.1</b> Conditional statements</a><ul>
<li class="chapter" data-level="" data-path="conditional-statements-and-loops.html"><a href="conditional-statements-and-loops.html#if"><i class="fa fa-check"></i>if</a></li>
<li class="chapter" data-level="" data-path="conditional-statements-and-loops.html"><a href="conditional-statements-and-loops.html#ifelse"><i class="fa fa-check"></i>if…else</a></li>
<li class="chapter" data-level="" data-path="conditional-statements-and-loops.html"><a href="conditional-statements-and-loops.html#nested-ifelse-statements"><i class="fa fa-check"></i>Nested if…else statements</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="conditional-statements-and-loops.html"><a href="conditional-statements-and-loops.html#loops"><i class="fa fa-check"></i><b>7.2</b> Loops</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="manipulating-data-in-the-tidyverse.html"><a href="manipulating-data-in-the-tidyverse.html"><i class="fa fa-check"></i><b>8</b> Manipulating Data in the tidyverse</a><ul>
<li class="chapter" data-level="8.1" data-path="manipulating-data-in-the-tidyverse.html"><a href="manipulating-data-in-the-tidyverse.html#what-is-the-tidyverse"><i class="fa fa-check"></i><b>8.1</b> What is the Tidyverse</a></li>
<li class="chapter" data-level="8.2" data-path="manipulating-data-in-the-tidyverse.html"><a href="manipulating-data-in-the-tidyverse.html#tibbles"><i class="fa fa-check"></i><b>8.2</b> Tibbles</a><ul>
<li class="chapter" data-level="" data-path="manipulating-data-in-the-tidyverse.html"><a href="manipulating-data-in-the-tidyverse.html#create-a-tibble"><i class="fa fa-check"></i>Create a tibble</a></li>
<li class="chapter" data-level="" data-path="manipulating-data-in-the-tidyverse.html"><a href="manipulating-data-in-the-tidyverse.html#reading-in-tibbles"><i class="fa fa-check"></i>Reading in tibbles</a></li>
<li class="chapter" data-level="" data-path="manipulating-data-in-the-tidyverse.html"><a href="manipulating-data-in-the-tidyverse.html#data-frames-versus-tibbles"><i class="fa fa-check"></i>Data frames versus tibbles</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="manipulating-data-in-the-tidyverse.html"><a href="manipulating-data-in-the-tidyverse.html#exploring-tibbles"><i class="fa fa-check"></i><b>8.3</b> Exploring tibbles</a></li>
<li class="chapter" data-level="8.4" data-path="manipulating-data-in-the-tidyverse.html"><a href="manipulating-data-in-the-tidyverse.html#tidy-data"><i class="fa fa-check"></i><b>8.4</b> Tidy data</a><ul>
<li><a href="manipulating-data-in-the-tidyverse.html#gather"><code>gather()</code></a></li>
<li><a href="manipulating-data-in-the-tidyverse.html#separate"><code>separate()</code></a></li>
<li><a href="manipulating-data-in-the-tidyverse.html#spread"><code>spread()</code></a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="manipulating-data-in-the-tidyverse.html"><a href="manipulating-data-in-the-tidyverse.html#what-is-dplyr"><i class="fa fa-check"></i><b>8.5</b> What is dplyr?</a></li>
<li class="chapter" data-level="8.6" data-path="manipulating-data-in-the-tidyverse.html"><a href="manipulating-data-in-the-tidyverse.html#selecting-columns-and-filtering-rows"><i class="fa fa-check"></i><b>8.6</b> Selecting columns and filtering rows</a></li>
<li class="chapter" data-level="8.7" data-path="manipulating-data-in-the-tidyverse.html"><a href="manipulating-data-in-the-tidyverse.html#pipes"><i class="fa fa-check"></i><b>8.7</b> Pipes</a></li>
<li class="chapter" data-level="8.8" data-path="manipulating-data-in-the-tidyverse.html"><a href="manipulating-data-in-the-tidyverse.html#mutate"><i class="fa fa-check"></i><b>8.8</b> Mutate</a></li>
<li class="chapter" data-level="8.9" data-path="manipulating-data-in-the-tidyverse.html"><a href="manipulating-data-in-the-tidyverse.html#split-apply-combine-data-analysis-and-the-summarize-function"><i class="fa fa-check"></i><b>8.9</b> Split-apply-combine data analysis and the summarize() function</a></li>
<li class="chapter" data-level="8.10" data-path="manipulating-data-in-the-tidyverse.html"><a href="manipulating-data-in-the-tidyverse.html#other-great-resources"><i class="fa fa-check"></i><b>8.10</b> Other great resources</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="data-visualization-with-ggplot2.html"><a href="data-visualization-with-ggplot2.html"><i class="fa fa-check"></i><b>9</b> Data Visualization with ggplot2</a><ul>
<li class="chapter" data-level="9.1" data-path="data-visualization-with-ggplot2.html"><a href="data-visualization-with-ggplot2.html#data"><i class="fa fa-check"></i><b>9.1</b> Data</a></li>
<li class="chapter" data-level="9.2" data-path="data-visualization-with-ggplot2.html"><a href="data-visualization-with-ggplot2.html#plotting-with-ggplot2"><i class="fa fa-check"></i><b>9.2</b> Plotting with ggplot2</a><ul>
<li class="chapter" data-level="" data-path="data-visualization-with-ggplot2.html"><a href="data-visualization-with-ggplot2.html#principles-of-effective-display"><i class="fa fa-check"></i>Principles of effective display</a></li>
<li class="chapter" data-level="" data-path="data-visualization-with-ggplot2.html"><a href="data-visualization-with-ggplot2.html#building-plots-iteratively"><i class="fa fa-check"></i>Building plots iteratively</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="data-visualization-with-ggplot2.html"><a href="data-visualization-with-ggplot2.html#faceting"><i class="fa fa-check"></i><b>9.3</b> Faceting</a></li>
<li class="chapter" data-level="9.4" data-path="data-visualization-with-ggplot2.html"><a href="data-visualization-with-ggplot2.html#barplots"><i class="fa fa-check"></i><b>9.4</b> Barplots</a></li>
<li class="chapter" data-level="9.5" data-path="data-visualization-with-ggplot2.html"><a href="data-visualization-with-ggplot2.html#histograms"><i class="fa fa-check"></i><b>9.5</b> Histograms</a></li>
<li class="chapter" data-level="9.6" data-path="data-visualization-with-ggplot2.html"><a href="data-visualization-with-ggplot2.html#boxplots"><i class="fa fa-check"></i><b>9.6</b> Boxplots</a><ul>
<li class="chapter" data-level="" data-path="data-visualization-with-ggplot2.html"><a href="data-visualization-with-ggplot2.html#the-five-number-summary"><i class="fa fa-check"></i>The Five Number Summary</a></li>
</ul></li>
<li class="chapter" data-level="9.7" data-path="data-visualization-with-ggplot2.html"><a href="data-visualization-with-ggplot2.html#themes"><i class="fa fa-check"></i><b>9.7</b> Themes</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="project.html"><a href="project.html"><i class="fa fa-check"></i><b>10</b> Project</a><ul>
<li class="chapter" data-level="" data-path="project.html"><a href="project.html#introduction-1"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="" data-path="project.html"><a href="project.html#task-0-download-the-data"><i class="fa fa-check"></i>Task 0: Download the data</a></li>
<li class="chapter" data-level="" data-path="project.html"><a href="project.html#task-1-data-import-and-examination"><i class="fa fa-check"></i>Task 1: Data import and examination</a><ul>
<li class="chapter" data-level="" data-path="project.html"><a href="project.html#task-1-solution"><i class="fa fa-check"></i>Task 1 Solution</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="project.html"><a href="project.html#task-2-data-tidying"><i class="fa fa-check"></i>Task 2: Data Tidying</a><ul>
<li class="chapter" data-level="" data-path="project.html"><a href="project.html#task-2-solution"><i class="fa fa-check"></i>Task 2 Solution</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="project.html"><a href="project.html#task-3-plots"><i class="fa fa-check"></i>Task 3: Plots</a><ul>
<li class="chapter" data-level="" data-path="project.html"><a href="project.html#task-3-solution"><i class="fa fa-check"></i>Task 3 Solution</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="project.html"><a href="project.html#task-4-heatmap"><i class="fa fa-check"></i>Task 4: Heatmap</a><ul>
<li class="chapter" data-level="" data-path="project.html"><a href="project.html#task-4-solution"><i class="fa fa-check"></i>Task 4 Solution</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="summary.html"><a href="summary.html"><i class="fa fa-check"></i><b>11</b> Summary</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Introduction to R for Biologists</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="project" class="section level1">
<h1><span class="header-section-number">10</span> Project</h1>
<div id="introduction-1" class="section level2 unnumbered">
<h2>Introduction</h2>
<p>The data we’re going to work with comes from a yeast microarray experiment <a href="http://www.molbiolcell.org/content/19/1/352.abstract">(Brauer, 2008)</a> where the authors measured gene expression in 36 chemostat cultures where growth was limited by one of six nutrients (glucose, ammonium, sulfate, phosphate, uracil, or leucine) at 6 different growth rates.</p>
<p>The R world is full of niche tools designed for a specific problem or data type. This is particularly true for Bioconductor and genomics analysis. RNA-seq is a good example where all data import, analysis, and even plotting is done with custom packages and functions designed for gene expression data. Analysis of microbiome data with phyloseq is another example. Now this is not a bad thing and can enable simple, rapid analysis. Yet the point of learning a programming language like R is so you can take back control of your analysis and put the tools to work for your specific problem.</p>
<p>For this project we’re going to take some genomic data and pull it out of the context that it’s usually analyzed in. Bioconductor has a plethora of tools for analyzing microarray data and the <code>limma</code> package is by far the most comprehensive and useful. However, for our project we’re going to take microarray data that has already been processed and instead use it with data analysis tools that we’ve been learning.</p>
<p>The take-away from this project to make the tools work for you instead of you working for them. Data, genomic or not, is still data and we can use the tools available to us in R to gain valuable insights.</p>
<p><br></p>
</div>
<div id="task-0-download-the-data" class="section level2 unnumbered">
<h2>Task 0: Download the data</h2>
<p>You can find the data for download from dropbox <a href="https://www.dropbox.com/s/z0c72rmzaqfr6ma/Brauer2008_DataSet1.csv?dl=0">here</a>.</p>
<p><br></p>
</div>
<div id="task-1-data-import-and-examination" class="section level2 unnumbered">
<h2>Task 1: Data import and examination</h2>
<p>The first task of almost all analysis is to get the data into R and spend a little time understanding it’s structure. Although you may be tempted to rush into an analysis it pays to take a bit of time to understand what you are working with and do some cleaning before you dive in too deep. This is important help you avoid costly mistakes and wasted time downstream.</p>
<p>The data file you’ll be using is <code>Brauer2008_DataSet1.csv</code> and although it is pre-processed it will still need some work to get it ready to use.</p>
<p>Your goal is get the data loaded into R and answer the following questions:</p>
<ol style="list-style-type: decimal">
<li>How many rows and columns are there?</li>
<li>What do the rows and columns represent?</li>
<li>On first glimpse do the column datatypes look correct?</li>
<li>What about column names?</li>
<li>Is this data tidy? Why or why not?</li>
</ol>
<p>As you look through the data start thinking about what steps you’ll need to get it into a workable state.</p>
<p><br></p>
<div id="task-1-solution" class="section level3 unnumbered">
<h3>Task 1 Solution</h3>
<p><b>1. How many rows and columns are there?</b></p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="kw">library</span>(tidyverse)</a></code></pre></div>
<pre><code>## ── Attaching packages ─── tidyverse 1.3.0 ──</code></pre>
<pre><code>## ✓ ggplot2 3.2.1     ✓ purrr   0.3.3
## ✓ tibble  2.1.3     ✓ dplyr   0.8.4
## ✓ tidyr   1.0.2     ✓ stringr 1.4.0
## ✓ readr   1.3.1     ✓ forcats 0.4.0</code></pre>
<pre><code>## ── Conflicts ────── tidyverse_conflicts() ──
## x dplyr::filter() masks stats::filter()
## x dplyr::lag()    masks stats::lag()</code></pre>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1">raw &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;data/Brauer2008_DataSet1.csv&quot;</span>)</a>
<a class="sourceLine" id="cb5-2" data-line-number="2"><span class="co">#head(raw)</span></a>
<a class="sourceLine" id="cb5-3" data-line-number="3"><span class="kw">dim</span>(raw)</a></code></pre></div>
<pre><code>## [1] 5537   40</code></pre>
<p>There are 5537 rows and 40 columns.</p>
<p><b>2. What do the rows and columns represent?</b></p>
<p>Rows are genes and columns are a mix of different variables including gene names and expression values.</p>
<p><b>3. On first glimpse do the column datatypes look correct?</b></p>
<p>Yes, it seems that R has guessed correctly on what the values should be.</p>
<p><b>4. What about column names? </b></p>
<p>The columns that have the gene expression values don’t look right. Something is up with that period in there.</p>
<p><b>5. Is this data tidy? Why or why not?</b></p>
<p>It’s not. Each observation does not form a row and each variable does not form a column.</p>
<p><br></p>
</div>
</div>
<div id="task-2-data-tidying" class="section level2 unnumbered">
<h2>Task 2: Data Tidying</h2>
<p>Never underestimate the amount of time and effort it will take to tame a wild dataset into something usable. Even if someone has already processed and “cleaned” the data before you (such as our current dataset) it is likely that you will need to spend some time fiddling with it for your particular needs (or for a particular function you want to use).</p>
<p>You’ve learned about the tidy data concepts, now it’s time to put them into practice. The first and most important step is decide what, if any tidying needs to be done. Recall that:</p>
<ul>
<li>Each variable forms a column.</li>
<li>Each observation forms a row.</li>
<li>Each type of observational unit forms a table.</li>
</ul>
<p>Questions to answer:</p>
<ol style="list-style-type: decimal">
<li>Which column contains multiple variables? Split it up so each column represents a single variable.</li>
<li>The <code>GWEIGHT</code>, <code>GID</code>, and <code>YORF</code> columns we also won’t need so you can get rid of those.</li>
<li>What’s wrong with the column names? How can you fix that?</li>
<li>Check again: do you have any columns that have multiple variables? Be sure to fix any before you move on.</li>
</ol>
<p>Try to code all the cleaning steps as a single pipeline. Remember the <code>separate()</code> and <code>gather()</code> functions from the tidyr package.</p>
<p><strong>Bonus:</strong> Your cleaning steps may have left some variables with extra white space at the end. Using <code>dplyr::mutate_at()</code> and a certain function from the <code>stringr</code> package see if you can clean these up.</p>
<p><br></p>
<div id="task-2-solution" class="section level3 unnumbered">
<h3>Task 2 Solution</h3>
<p><b>1. Which column contains multiple variables? Split it up so each column represents a single variable.</b></p>
<p>We need to tell <code>separate()</code> to split on the <code>||</code> character using the <code>sep</code> argument. However, the <code>|</code> character is actually a special character for something called regular expressions, which we don’t need to worry about right now. That’s why we need to use the double backslash, which “escapes” the <code>|</code> character and tells <code>separate()</code> to interpret it like a normal character. If we used <code>sep = &quot;||&quot;</code> this would give us the wrong result.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1">clean &lt;-<span class="st"> </span>raw <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb7-2" data-line-number="2"><span class="st">  </span><span class="kw">separate</span>(NAME, <span class="kw">c</span>(<span class="st">&quot;gene_name&quot;</span>, <span class="st">&quot;BP&quot;</span>, <span class="st">&quot;MP&quot;</span>, <span class="st">&quot;gene_id&quot;</span>, <span class="st">&quot;number&quot;</span>), <span class="dt">sep =</span> <span class="st">&quot;</span><span class="ch">\\</span><span class="st">|</span><span class="ch">\\</span><span class="st">|&quot;</span>) </a></code></pre></div>
<p><b>2. The <code>GWEIGHT</code>, <code>GID</code>, and <code>YORF</code> columns we also won’t need so you can get rid of those.</b></p>
<p>That’s easy with <code>select()</code>.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1">clean &lt;-<span class="st"> </span>raw <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb8-2" data-line-number="2"><span class="st">  </span><span class="kw">separate</span>(NAME, <span class="kw">c</span>(<span class="st">&quot;gene_name&quot;</span>, <span class="st">&quot;BP&quot;</span>, <span class="st">&quot;MP&quot;</span>, <span class="st">&quot;gene_id&quot;</span>, <span class="st">&quot;number&quot;</span>), <span class="dt">sep =</span> <span class="st">&quot;</span><span class="ch">\\</span><span class="st">|</span><span class="ch">\\</span><span class="st">|&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb8-3" data-line-number="3"><span class="st">  </span><span class="kw">select</span>(<span class="op">-</span>GWEIGHT, <span class="op">-</span>GID, <span class="op">-</span>YORF)</a></code></pre></div>
<p><b>3. What’s wrong with the column names? How can you fix that?</b></p>
<p>They’re variables not names and tidy data principles tell us that each variable should be a column. And these are not just not just 1 variable - both nutrient and growth rate are present. We can fix this with <code>gather()</code>.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1">clean &lt;-<span class="st"> </span>raw <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb9-2" data-line-number="2"><span class="st">  </span><span class="kw">separate</span>(NAME, <span class="kw">c</span>(<span class="st">&quot;gene_name&quot;</span>, <span class="st">&quot;BP&quot;</span>, <span class="st">&quot;MP&quot;</span>, <span class="st">&quot;gene_id&quot;</span>, <span class="st">&quot;number&quot;</span>), <span class="dt">sep =</span> <span class="st">&quot;</span><span class="ch">\\</span><span class="st">|</span><span class="ch">\\</span><span class="st">|&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb9-3" data-line-number="3"><span class="st">  </span><span class="kw">select</span>(<span class="op">-</span>GWEIGHT, <span class="op">-</span>GID, <span class="op">-</span>YORF) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb9-4" data-line-number="4"><span class="st">  </span><span class="kw">gather</span>(variable, expression, G0<span class="fl">.05</span><span class="op">:</span>U0<span class="fl">.3</span>)</a></code></pre></div>
<p><b>4. Check again: do you have any columns that have multipe variables? Be sure to fix any before you move on.</b></p>
<p>Why yes, it seems that our <code>variable</code> column is comprised of both nutrient and growth rate. We’ll have to use <code>separate()</code> again. The trick here is how to specify the correct place to split the variable. We want the first letter in one column (nutrient) and the the remaining part in a second column (growth_rate). If you read the help for the <code>separate()</code> function you’ll see that if you provide a number to the <code>sep</code> argument it will split at this position. This works great for us. There are other ways to split this variable, however, these require a bit more knowledge of regular expressions. And always go with the simplist soluion you can find.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1">clean &lt;-<span class="st"> </span>raw <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb10-2" data-line-number="2"><span class="st">  </span><span class="kw">separate</span>(NAME, <span class="kw">c</span>(<span class="st">&quot;gene_name&quot;</span>, <span class="st">&quot;BP&quot;</span>, <span class="st">&quot;MP&quot;</span>, <span class="st">&quot;gene_id&quot;</span>, <span class="st">&quot;number&quot;</span>), <span class="dt">sep =</span> <span class="st">&quot;</span><span class="ch">\\</span><span class="st">|</span><span class="ch">\\</span><span class="st">|&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb10-3" data-line-number="3"><span class="st">  </span><span class="kw">select</span>(<span class="op">-</span>GWEIGHT, <span class="op">-</span>GID, <span class="op">-</span>YORF) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb10-4" data-line-number="4"><span class="st">  </span><span class="kw">gather</span>(variable, expression, G0<span class="fl">.05</span><span class="op">:</span>U0<span class="fl">.3</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb10-5" data-line-number="5"><span class="st">  </span><span class="kw">separate</span>(variable, <span class="kw">c</span>(<span class="st">&quot;nutrient&quot;</span>, <span class="st">&quot;growth_rate&quot;</span>), <span class="dt">sep =</span> <span class="dv">1</span>)</a></code></pre></div>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" data-line-number="1"><span class="kw">head</span>(clean<span class="op">$</span>BP)</a></code></pre></div>
<pre><code>## [1] &quot; ER to Golgi transport &quot;        &quot; biological process unknown &quot;  
## [3] &quot; proteolysis and peptidolysis &quot; &quot; mRNA polyadenylylation* &quot;     
## [5] &quot; vesicle fusion* &quot;              &quot; biological process unknown &quot;</code></pre>
<p><strong>Bonus</strong></p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" data-line-number="1">clean &lt;-<span class="st"> </span>raw <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb13-2" data-line-number="2"><span class="st">  </span><span class="kw">separate</span>(NAME, <span class="kw">c</span>(<span class="st">&quot;gene_name&quot;</span>, <span class="st">&quot;BP&quot;</span>, <span class="st">&quot;MP&quot;</span>, <span class="st">&quot;gene_id&quot;</span>, <span class="st">&quot;number&quot;</span>), <span class="dt">sep =</span> <span class="st">&quot;</span><span class="ch">\\</span><span class="st">|</span><span class="ch">\\</span><span class="st">|&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb13-3" data-line-number="3"><span class="st">  </span><span class="kw">select</span>(<span class="op">-</span>GWEIGHT, <span class="op">-</span>GID, <span class="op">-</span>YORF) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb13-4" data-line-number="4"><span class="st">  </span><span class="kw">gather</span>(variable, expression, G0<span class="fl">.05</span><span class="op">:</span>U0<span class="fl">.3</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb13-5" data-line-number="5"><span class="st">  </span><span class="kw">separate</span>(variable, <span class="kw">c</span>(<span class="st">&quot;nutrient&quot;</span>, <span class="st">&quot;growth_rate&quot;</span>), <span class="dt">sep =</span> <span class="dv">1</span>, <span class="dt">convert =</span> <span class="ot">TRUE</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb13-6" data-line-number="6"><span class="st">  </span><span class="kw">mutate_at</span>(<span class="kw">vars</span>(gene_name<span class="op">:</span>gene_id), str_trim)</a>
<a class="sourceLine" id="cb13-7" data-line-number="7"><span class="kw">head</span>(clean)</a></code></pre></div>
<pre><code>##   gene_name                           BP                            MP gene_id
## 1      SFB2        ER to Golgi transport    molecular function unknown YNL049C
## 2             biological process unknown    molecular function unknown YNL095C
## 3      QRI7 proteolysis and peptidolysis metalloendopeptidase activity YDL104C
## 4      CFT2      mRNA polyadenylylation*                   RNA binding YLR115W
## 5      SSO2              vesicle fusion*              t-SNARE activity YMR183C
## 6      PSP2   biological process unknown    molecular function unknown YML017W
##     number nutrient growth_rate expression
## 1  1082129        G        0.05      -0.24
## 2  1086222        G        0.05       0.28
## 3  1085955        G        0.05      -0.02
## 4  1081958        G        0.05      -0.33
## 5  1081214        G        0.05       0.05
## 6  1083036        G        0.05      -0.69</code></pre>
<p><br></p>
</div>
</div>
<div id="task-3-plots" class="section level2 unnumbered">
<h2>Task 3: Plots</h2>
<p>Whew! Alright, that’s done, but now you might asking why spend all that time cleaning up the data. Hopefully you should be able to answer that question by now but moving on to making some plots will help make it even more clear.</p>
<p>In a typical analysis you wouldn’t necessarily know which gene(s) to start looking at and would want to start with some more exploratory analysis. However, to practice our plotting and analysis let’s focus on a few pre-picked genes and pathways.</p>
<ol style="list-style-type: decimal">
<li>Filter your now cleaned data to contain only the gene LEU1.</li>
<li>Make a plot of the expression of this gene at various growth rates. Use colour to distinguish the different nutrients.</li>
<li>What are some conclusions you can make from this data?</li>
<li>What biological process is LEU1 classified as?</li>
<li>Filter your cleaned data for all genes that are in the same biological process as LEU!.</li>
<li>Make a plot of these genes, the same as you had for LEU1 but faceted by gene.</li>
<li>Do any of the other genes follow the same pattern as LEU1?<br />
</li>
<li>Customize your plot a bit by changing the colour palette to one of the RColorBrewer palettes. Explore some of the other themes available (<code>theme_bw()</code> is particularly nice). Fix the x-axis and y-axis labels so they look nicer.</li>
</ol>
<p><strong>Bonus:</strong> To increase readability of the plot it can helpful to change those nutrients from letters to full words. Although there are ways to do this directly in ggplot the easiest is to change it in the original data.</p>
<p><br></p>
<div id="task-3-solution" class="section level3 unnumbered">
<h3>Task 3 Solution</h3>
<p><b>1. Filter your now cleaned data to contain only the gene LEU1.</b></p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" data-line-number="1">leu&lt;-<span class="st"> </span>clean <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb15-2" data-line-number="2"><span class="st">  </span><span class="kw">filter</span>(gene_name <span class="op">==</span><span class="st"> &quot;LEU1&quot;</span>)</a></code></pre></div>
<p><b>2. Make a plot of the expression of this gene at various growth rates. Use colour to distinguish the different nutrients.</b></p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" data-line-number="1">clean <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb16-2" data-line-number="2"><span class="st">  </span><span class="kw">filter</span>(gene_name <span class="op">==</span><span class="st"> &quot;LEU1&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb16-3" data-line-number="3"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> growth_rate, <span class="dt">y =</span> expression)) <span class="op">+</span></a>
<a class="sourceLine" id="cb16-4" data-line-number="4"><span class="st">    </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">colour =</span> nutrient))</a></code></pre></div>
<p><img src="IntroRWorkshop_files/figure-html/unnamed-chunk-10-1.png" width="672" /></p>
<p><b>3. What are some conclusions you can make from this data?</b></p>
<ul>
<li>When leucine is limiting the expression of LEU1 is higher than when any of the other nutrients are limiting.</li>
<li>As growth rate increase the expresison of LEU1 decreases but only in leucine limiting conditions. In all other conditions it increases as growth rate increases.</li>
</ul>
<p><b>4. What biological process is LEU1 classified as?</b></p>
<p>leucine biosynthesis</p>
<p><b>5. Filter your cleaned data for all genes that are in the same biological process as LEU1.</b></p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" data-line-number="1">lbs&lt;-<span class="st"> </span>clean <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb17-2" data-line-number="2"><span class="st">  </span><span class="kw">filter</span>(BP <span class="op">==</span><span class="st"> &quot;leucine biosynthesis&quot;</span>)</a></code></pre></div>
<p><b>6. Make a plot of these genes, the same as you had for LEU1 but faceted by gene.</b></p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" data-line-number="1">clean <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb18-2" data-line-number="2"><span class="st">  </span><span class="kw">filter</span>(BP <span class="op">==</span><span class="st"> &quot;leucine biosynthesis&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb18-3" data-line-number="3"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> growth_rate, <span class="dt">y =</span> expression)) <span class="op">+</span></a>
<a class="sourceLine" id="cb18-4" data-line-number="4"><span class="st">    </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">colour =</span> nutrient)) <span class="op">+</span></a>
<a class="sourceLine" id="cb18-5" data-line-number="5"><span class="st">    </span><span class="kw">facet_wrap</span>(<span class="op">~</span>gene_name)</a></code></pre></div>
<p><img src="IntroRWorkshop_files/figure-html/unnamed-chunk-12-1.png" width="672" /></p>
<p><b>7. Do any of the other genes follow the same pattern as LEU1?</b></p>
<p>LEU2 seems to but the expression difference in leucine limiting conditions is not quite so high.</p>
<p><b>8. Make it pretty</b></p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" data-line-number="1">clean <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb19-2" data-line-number="2"><span class="st">  </span><span class="kw">filter</span>(BP <span class="op">==</span><span class="st"> &quot;leucine biosynthesis&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb19-3" data-line-number="3"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> growth_rate, <span class="dt">y =</span> expression, <span class="dt">colour =</span> nutrient)) <span class="op">+</span></a>
<a class="sourceLine" id="cb19-4" data-line-number="4"><span class="st">    </span><span class="kw">geom_line</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb19-5" data-line-number="5"><span class="st">    </span><span class="kw">geom_point</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb19-6" data-line-number="6"><span class="st">    </span><span class="kw">facet_wrap</span>(<span class="op">~</span>gene_name) <span class="op">+</span></a>
<a class="sourceLine" id="cb19-7" data-line-number="7"><span class="st">    </span><span class="kw">scale_color_brewer</span>(<span class="st">&quot;Nutrient&quot;</span>, <span class="dt">palette =</span> <span class="st">&quot;Accent&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb19-8" data-line-number="8"><span class="st">    </span><span class="kw">theme_bw</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb19-9" data-line-number="9"><span class="st">    </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Growth Rate&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;Expression (log2)&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb19-10" data-line-number="10"><span class="st">    </span><span class="kw">theme</span>(<span class="dt">strip.background =</span> <span class="kw">element_blank</span>())</a></code></pre></div>
<p><img src="IntroRWorkshop_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
<p><b>Bonus: Changing nutrient names</b></p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb20-1" data-line-number="1">nutrient_key =<span class="st"> </span><span class="kw">c</span>(</a>
<a class="sourceLine" id="cb20-2" data-line-number="2">  <span class="dt">G =</span> <span class="st">&quot;Glucose&quot;</span>,</a>
<a class="sourceLine" id="cb20-3" data-line-number="3">  <span class="dt">N =</span> <span class="st">&quot;Ammonium&quot;</span>,</a>
<a class="sourceLine" id="cb20-4" data-line-number="4">  <span class="dt">P =</span> <span class="st">&quot;Phosphate&quot;</span>,</a>
<a class="sourceLine" id="cb20-5" data-line-number="5">  <span class="dt">S =</span> <span class="st">&quot;Sulfate&quot;</span>,</a>
<a class="sourceLine" id="cb20-6" data-line-number="6">  <span class="dt">U =</span> <span class="st">&quot;Uracil&quot;</span>,</a>
<a class="sourceLine" id="cb20-7" data-line-number="7">  <span class="dt">L =</span> <span class="st">&quot;Leucine&quot;</span></a>
<a class="sourceLine" id="cb20-8" data-line-number="8">)</a>
<a class="sourceLine" id="cb20-9" data-line-number="9">nutrient_key[<span class="st">&quot;P&quot;</span>]</a></code></pre></div>
<pre><code>##           P 
## &quot;Phosphate&quot;</code></pre>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb22-1" data-line-number="1">clean <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb22-2" data-line-number="2"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">nutrient_names =</span> nutrient_key[nutrient]) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb22-3" data-line-number="3"><span class="st">    </span><span class="kw">filter</span>(BP <span class="op">==</span><span class="st"> &quot;leucine biosynthesis&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb22-4" data-line-number="4"><span class="st">    </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> growth_rate, <span class="dt">y =</span> expression, <span class="dt">colour =</span> nutrient_names)) <span class="op">+</span></a>
<a class="sourceLine" id="cb22-5" data-line-number="5"><span class="st">    </span><span class="kw">geom_line</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb22-6" data-line-number="6"><span class="st">    </span><span class="kw">geom_point</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb22-7" data-line-number="7"><span class="st">    </span><span class="kw">facet_wrap</span>(<span class="op">~</span>gene_name) <span class="op">+</span></a>
<a class="sourceLine" id="cb22-8" data-line-number="8"><span class="st">    </span><span class="kw">scale_color_brewer</span>(<span class="st">&quot;Nutrient&quot;</span>, <span class="dt">palette =</span> <span class="st">&quot;Accent&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb22-9" data-line-number="9"><span class="st">    </span><span class="kw">theme_bw</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb22-10" data-line-number="10"><span class="st">    </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Growth Rate&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;Expression (log2)&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb22-11" data-line-number="11"><span class="st">    </span><span class="kw">theme</span>(<span class="dt">strip.background =</span> <span class="kw">element_blank</span>())</a></code></pre></div>
<p><img src="IntroRWorkshop_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
<p><br></p>
</div>
</div>
<div id="task-4-heatmap" class="section level2 unnumbered">
<h2>Task 4: Heatmap</h2>
<p>Heatmaps are quite popular but generally useless visualisations used frequently in the genomic sciences. They can show a large amount of information in a small space, however, this very feature often renders them useless in terms of interpretability. Yet, for some applications they can be useful and let’s face it, your supervisor propbably wants one so it’s a good skill to have.</p>
<p>Heatmaps are very straight forward to make with ggplot using <code>geom_tile()</code> however, one of the more useful features of heatmap is the row and column ordering usually done with hierarchical clustering. This is non-trivial (but not impossible) to implement with ggplot so instead we’re going to look at a package specifically designed for these types of heatmaps. There are as many heatmap packages for R as there are heatmaps and you may end up using different packages for different purposes. However, the <code>pheatmap</code> package has a nice balance of features, speed, and ease of use and is the one we’ll work with today, although you are free to look at others for your own needs.</p>
<p>To this point much of your training has focused on the concepts of tidy data analysis, which are very powerful and you will come to rely on for much of your work. However, for genomics and other bioinformatics analysis you will often find yourself having to go between the <em>tidyverse</em> and other custom formats and datatypes specific to another package or the more traditional R datatypes, particularly the matrix format. In addition to learning how to make a nice heatmap the other main goal of this task is to help you become familar with moving back and forth between different data structures.</p>
<p>Questions to answer:</p>
<ol style="list-style-type: decimal">
<li>Start by installing the <code>pheatmap</code> package from CRAN. Have a look at the help page for the <code>pheatmap()</code> function. Which argument specifies the data? What format does it need?</li>
<li>Using what you learned from the help function get the gene expression data into a format that <code>pheatmap()</code> can use. Think about what you want your heatmap to look like - what are the columns and rows?</li>
<li>Once you’ve got data in the correct format start by making a simple heatmap with default parameters. Do you like it? Is there anything wrong with it? What would change from a data interpretation perspective? What about from aethetics perspective?</li>
</ol>
<div id="task-4-solution" class="section level3 unnumbered">
<h3>Task 4 Solution</h3>
<p><b>1. Start by installing the <code>pheatmap</code> package from CRAN. Have a look at the help page for the <code>pheatamp()</code> function. Which argument specifies the data? What format does it need?</b></p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb23-1" data-line-number="1"><span class="co">#install.packages(&quot;pheatmap&quot;)</span></a>
<a class="sourceLine" id="cb23-2" data-line-number="2"><span class="kw">library</span>(pheatmap)</a>
<a class="sourceLine" id="cb23-3" data-line-number="3">?pheatmap</a></code></pre></div>
<p>Looks like <code>pheatmap()</code> needs a numeric matix given with the <code>mat</code> arguments, which is the first and only required arugment.</p>
<p><b>2. Using what you learned from the help function get the gene expression data into a format that <code>pheatmap()</code> can use. Think about what you want your heatmap to look like - what are the columns and rows?</b></p>
<p>Here we’re going to go back to our pre-tidied data. This doesn’t negate the work we did to tidy it nor does it mean the the data is now ‘dirty’ or bad somehow. Tidy data is standardized but many R tools still don’t work with data in this format and so we must adapt.</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb24-1" data-line-number="1"><span class="co">#head(raw)</span></a>
<a class="sourceLine" id="cb24-2" data-line-number="2">hm_mat &lt;-<span class="st"> </span>raw <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb24-3" data-line-number="3"><span class="st">  </span><span class="kw">select</span>(<span class="op">-</span>GID, <span class="op">-</span>YORF, <span class="op">-</span>NAME, <span class="op">-</span>GWEIGHT) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb24-4" data-line-number="4"><span class="st">  </span><span class="kw">as.matrix</span>()</a>
<a class="sourceLine" id="cb24-5" data-line-number="5"></a>
<a class="sourceLine" id="cb24-6" data-line-number="6"><span class="kw">class</span>(hm_mat)</a></code></pre></div>
<pre><code>## [1] &quot;matrix&quot;</code></pre>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb26-1" data-line-number="1"><span class="kw">typeof</span>(hm_mat)</a></code></pre></div>
<pre><code>## [1] &quot;double&quot;</code></pre>
<p><b>3. Once you’ve got data in the correct format start by making a simple heatmap with default parameters. Do you like it? Is there anything wrong with it? What would change from a data interpretation perspective? What about from aethetics perspective?</b></p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb28-1" data-line-number="1"><span class="kw">pheatmap</span>(hm_mat)</a></code></pre></div>
<p><img src="IntroRWorkshop_files/figure-html/unnamed-chunk-17-1.png" width="672" /></p>
<p>Overall this actually looks pretty good. Because these data have already been normalized and scaled we don’t need to do much here but there are few tweaks that may help.</p>
<ul>
<li>The default is to order both the rows and columns, however, because this is a timecourse experiment we may not want to order the columns. In fact if we look at the raw data we see that the columns are already ordered by time.</li>
<li>The colours are better than the typical red/green (which you should NEVER use, BTW) but still leave something to be desired. This could be changed in a final version of the plot. Note that we have a diverging colour scale with values ranging from -6 to +6. This is becuase these data are mean-centred. Blue (negative) values are below the mean for that gene and red values (positive) are above the mean for that gene. Yellow is the mean expression for that gene. Mean-centering is a handy way to show fold-changes, but should always be displayed with a diverging colour scale.</li>
<li>To help with visualizing the different nutrients, we can add gaps to the heatmap to make a column for each nutrient.</li>
</ul>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb29-1" data-line-number="1"><span class="kw">library</span>(RColorBrewer)</a>
<a class="sourceLine" id="cb29-2" data-line-number="2"><span class="kw">pheatmap</span>(hm_mat,</a>
<a class="sourceLine" id="cb29-3" data-line-number="3">         <span class="dt">cluster_cols =</span> <span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb29-4" data-line-number="4">         <span class="dt">color =</span> <span class="kw">colorRampPalette</span>(<span class="kw">rev</span>(<span class="kw">brewer.pal</span>(<span class="dt">n =</span> <span class="dv">7</span>, <span class="dt">name =</span> <span class="st">&quot;RdBu&quot;</span>)))(<span class="dv">100</span>),</a>
<a class="sourceLine" id="cb29-5" data-line-number="5">         <span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="op">-</span><span class="dv">5</span>, <span class="dv">5</span>, <span class="dt">length.out =</span> <span class="dv">101</span>),</a>
<a class="sourceLine" id="cb29-6" data-line-number="6">         <span class="dt">gaps_col =</span> <span class="kw">c</span>(<span class="dv">6</span>,<span class="dv">12</span>,<span class="dv">18</span>,<span class="dv">24</span>,<span class="dv">30</span>)</a>
<a class="sourceLine" id="cb29-7" data-line-number="7">)</a></code></pre></div>
<p><img src="IntroRWorkshop_files/figure-html/unnamed-chunk-19-1.png" width="672" /></p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="data-visualization-with-ggplot2.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="summary.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["IntroRWorkshop.pdf", "IntroRWorkshop.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
