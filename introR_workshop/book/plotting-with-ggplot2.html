<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>10 Plotting with ggplot2 | Introduction to R for Biologists</title>
  <meta name="description" content="This tutorial covers workshop material" />
  <meta name="generator" content="bookdown 0.17 and GitBook 2.6.7" />

  <meta property="og:title" content="10 Plotting with ggplot2 | Introduction to R for Biologists" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This tutorial covers workshop material" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="10 Plotting with ggplot2 | Introduction to R for Biologists" />
  
  <meta name="twitter:description" content="This tutorial covers workshop material" />
  

<meta name="author" content="Alana Schick" />


<meta name="date" content="2020-03-08" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="data-visualization-with-ggplot2.html"/>
<link rel="next" href="building-plots-iteratively.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Intro R Workshop</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Welcome</a><ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#workshop-schedule"><i class="fa fa-check"></i><b>1.1</b> Workshop Schedule</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#day-1"><i class="fa fa-check"></i>Day 1</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#day-2"><i class="fa fa-check"></i>Day 2</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#important-links"><i class="fa fa-check"></i><b>1.2</b> Important links</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="pre-workshop.html"><a href="pre-workshop.html"><i class="fa fa-check"></i><b>2</b> Pre-workshop</a><ul>
<li class="chapter" data-level="2.1" data-path="pre-workshop.html"><a href="pre-workshop.html#installation"><i class="fa fa-check"></i><b>2.1</b> Installation</a><ul>
<li class="chapter" data-level="2.1.1" data-path="pre-workshop.html"><a href="pre-workshop.html#windows"><i class="fa fa-check"></i><b>2.1.1</b> Windows</a></li>
<li class="chapter" data-level="2.1.2" data-path="pre-workshop.html"><a href="pre-workshop.html#macos"><i class="fa fa-check"></i><b>2.1.2</b> MacOS</a></li>
<li class="chapter" data-level="2.1.3" data-path="pre-workshop.html"><a href="pre-workshop.html#linux"><i class="fa fa-check"></i><b>2.1.3</b> Linux</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="pre-workshop.html"><a href="pre-workshop.html#datacamp-courses"><i class="fa fa-check"></i><b>2.2</b> Datacamp Courses</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>3</b> Introduction</a><ul>
<li class="chapter" data-level="3.1" data-path="introduction.html"><a href="introduction.html#r-and-the-rstudio-ide"><i class="fa fa-check"></i><b>3.1</b> R and the RStudio IDE</a></li>
<li class="chapter" data-level="3.2" data-path="introduction.html"><a href="introduction.html#why-learn-r"><i class="fa fa-check"></i><b>3.2</b> Why learn R</a><ul>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html#r-does-not-involve-a-lot-of-pointing-and-clicking---thats-a-good-thing"><i class="fa fa-check"></i>R does not involve a lot of pointing and clicking - that’s a good thing!</a></li>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html#r-code-is-great-for-reproducibility"><i class="fa fa-check"></i>R code is great for reproducibility</a></li>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html#r-is-interdisciplinary-and-extensible"><i class="fa fa-check"></i>R is interdisciplinary and extensible</a></li>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html#r-works-on-data-of-all-shapes-and-sizes"><i class="fa fa-check"></i>R works on data of all shapes and sizes</a></li>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html#r-produces-high-quality-graphics"><i class="fa fa-check"></i>R produces high-quality graphics</a></li>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html#r-has-a-large-and-welcoming-community"><i class="fa fa-check"></i>R has a large and welcoming community</a></li>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html#interacting-with-r"><i class="fa fa-check"></i>Interacting with R</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="introduction.html"><a href="introduction.html#exercise---getting-familiar-with-the-r-environment"><i class="fa fa-check"></i><b>3.3</b> Exercise - Getting familiar with the R environment</a></li>
<li class="chapter" data-level="3.4" data-path="introduction.html"><a href="introduction.html#how-to-learn-more"><i class="fa fa-check"></i><b>3.4</b> How to learn more?</a><ul>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html#seeking-help"><i class="fa fa-check"></i>Seeking help</a></li>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html#i-am-stuck-i-get-an-error-message-that-i-dont-understand"><i class="fa fa-check"></i>I am stuck… I get an error message that I don’t understand</a></li>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html#asking-for-help"><i class="fa fa-check"></i>Asking for help</a></li>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html#where-to-ask-for-help"><i class="fa fa-check"></i>Where to ask for help?</a></li>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html#how-to-ask-for-r-help-useful-guidelines"><i class="fa fa-check"></i>How to ask for R help useful guidelines</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="installing-r-packages.html"><a href="installing-r-packages.html"><i class="fa fa-check"></i><b>4</b> Installing R Packages</a><ul>
<li class="chapter" data-level="4.1" data-path="installing-r-packages.html"><a href="installing-r-packages.html#what-are-r-packages"><i class="fa fa-check"></i><b>4.1</b> What are R packages?</a></li>
<li class="chapter" data-level="4.2" data-path="installing-r-packages.html"><a href="installing-r-packages.html#installing-r-packages-from-different-sources"><i class="fa fa-check"></i><b>4.2</b> Installing R packages from different sources</a><ul>
<li class="chapter" data-level="" data-path="installing-r-packages.html"><a href="installing-r-packages.html#cran"><i class="fa fa-check"></i>1. CRAN</a></li>
<li class="chapter" data-level="" data-path="installing-r-packages.html"><a href="installing-r-packages.html#bioconductor"><i class="fa fa-check"></i>2. Bioconductor</a></li>
<li class="chapter" data-level="" data-path="installing-r-packages.html"><a href="installing-r-packages.html#github"><i class="fa fa-check"></i>3. Github</a></li>
<li class="chapter" data-level="4.2.1" data-path="installing-r-packages.html"><a href="installing-r-packages.html#exercise"><i class="fa fa-check"></i><b>4.2.1</b> EXERCISE</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="installing-r-packages.html"><a href="installing-r-packages.html#loading-a-package"><i class="fa fa-check"></i><b>4.3</b> Loading a package</a><ul>
<li class="chapter" data-level="" data-path="installing-r-packages.html"><a href="installing-r-packages.html#exercise-1"><i class="fa fa-check"></i>EXERCISE</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="r-basics.html"><a href="r-basics.html"><i class="fa fa-check"></i><b>5</b> R Basics</a><ul>
<li class="chapter" data-level="5.1" data-path="r-basics.html"><a href="r-basics.html#creating-objects-in-r"><i class="fa fa-check"></i><b>5.1</b> Creating objects in R</a></li>
<li class="chapter" data-level="5.2" data-path="r-basics.html"><a href="r-basics.html#objects-vs.variables"><i class="fa fa-check"></i><b>5.2</b> Objects vs. variables</a></li>
<li class="chapter" data-level="5.3" data-path="r-basics.html"><a href="r-basics.html#comments"><i class="fa fa-check"></i><b>5.3</b> Comments</a><ul>
<li class="chapter" data-level="" data-path="r-basics.html"><a href="r-basics.html#exercise-2"><i class="fa fa-check"></i>EXERCISE</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="r-basics.html"><a href="r-basics.html#functions-and-their-arguments"><i class="fa fa-check"></i><b>5.4</b> Functions and their arguments</a><ul>
<li class="chapter" data-level="" data-path="r-basics.html"><a href="r-basics.html#exercise-3"><i class="fa fa-check"></i>EXERCISE</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="r-basics.html"><a href="r-basics.html#vectors"><i class="fa fa-check"></i><b>5.5</b> Vectors</a><ul>
<li class="chapter" data-level="" data-path="r-basics.html"><a href="r-basics.html#exercise-4"><i class="fa fa-check"></i>EXERCISE</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="r-basics.html"><a href="r-basics.html#indexing-vectors"><i class="fa fa-check"></i><b>5.6</b> Indexing vectors</a><ul>
<li class="chapter" data-level="" data-path="r-basics.html"><a href="r-basics.html#adding-values-to-vectors"><i class="fa fa-check"></i>Adding values to vectors</a></li>
<li class="chapter" data-level="" data-path="r-basics.html"><a href="r-basics.html#replacing-values-in-existing-vectors"><i class="fa fa-check"></i>Replacing values in existing vectors</a></li>
</ul></li>
<li class="chapter" data-level="5.7" data-path="r-basics.html"><a href="r-basics.html#conditional-subsetting"><i class="fa fa-check"></i><b>5.7</b> Conditional subsetting</a></li>
<li class="chapter" data-level="5.8" data-path="r-basics.html"><a href="r-basics.html#so-we-can-use-this-to-select-only-the-values-above-50"><i class="fa fa-check"></i><b>5.8</b> so we can use this to select only the values above 50</a><ul>
<li class="chapter" data-level="" data-path="r-basics.html"><a href="r-basics.html#exercise-5"><i class="fa fa-check"></i>EXERCISE</a></li>
</ul></li>
<li class="chapter" data-level="5.9" data-path="r-basics.html"><a href="r-basics.html#missing-data"><i class="fa fa-check"></i><b>5.9</b> Missing data</a><ul>
<li class="chapter" data-level="" data-path="r-basics.html"><a href="r-basics.html#exercise-6"><i class="fa fa-check"></i>EXERCISE</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="starting-with-data.html"><a href="starting-with-data.html"><i class="fa fa-check"></i><b>6</b> Starting with Data</a><ul>
<li class="chapter" data-level="6.1" data-path="starting-with-data.html"><a href="starting-with-data.html#download-the-data"><i class="fa fa-check"></i><b>6.1</b> Download the data</a></li>
<li class="chapter" data-level="6.2" data-path="starting-with-data.html"><a href="starting-with-data.html#csv-files"><i class="fa fa-check"></i><b>6.2</b> CSV files</a><ul>
<li class="chapter" data-level="" data-path="starting-with-data.html"><a href="starting-with-data.html#exercise-7"><i class="fa fa-check"></i>EXERCISE</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="starting-with-data.html"><a href="starting-with-data.html#sidenote-importing-data-from-excel"><i class="fa fa-check"></i><b>6.3</b> Sidenote: Importing data from Excel</a></li>
<li class="chapter" data-level="6.4" data-path="starting-with-data.html"><a href="starting-with-data.html#import-data"><i class="fa fa-check"></i><b>6.4</b> Import data</a></li>
<li class="chapter" data-level="6.5" data-path="starting-with-data.html"><a href="starting-with-data.html#what-are-data-frames"><i class="fa fa-check"></i><b>6.5</b> What are data frames?</a><ul>
<li class="chapter" data-level="" data-path="starting-with-data.html"><a href="starting-with-data.html#exercise-8"><i class="fa fa-check"></i>EXERCISE</a></li>
<li class="chapter" data-level="" data-path="starting-with-data.html"><a href="starting-with-data.html#saving-or-writing-a-data-frame"><i class="fa fa-check"></i>Saving or “writing” a data frame</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="starting-with-data.html"><a href="starting-with-data.html#what-are-factors"><i class="fa fa-check"></i><b>6.6</b> What are factors?</a><ul>
<li class="chapter" data-level="" data-path="starting-with-data.html"><a href="starting-with-data.html#the-sign"><i class="fa fa-check"></i>The $ sign</a></li>
</ul></li>
<li class="chapter" data-level="6.7" data-path="starting-with-data.html"><a href="starting-with-data.html#plotting-and-ordering-factors"><i class="fa fa-check"></i><b>6.7</b> Plotting and ordering factors</a></li>
<li class="chapter" data-level="6.8" data-path="starting-with-data.html"><a href="starting-with-data.html#subsetting-data-frames"><i class="fa fa-check"></i><b>6.8</b> Subsetting data frames</a><ul>
<li class="chapter" data-level="" data-path="starting-with-data.html"><a href="starting-with-data.html#exercise-9"><i class="fa fa-check"></i>EXERCISE</a></li>
</ul></li>
<li class="chapter" data-level="6.9" data-path="starting-with-data.html"><a href="starting-with-data.html#other-data-types"><i class="fa fa-check"></i><b>6.9</b> Other data types</a><ul>
<li class="chapter" data-level="" data-path="starting-with-data.html"><a href="starting-with-data.html#matrices"><i class="fa fa-check"></i>Matrices</a></li>
<li class="chapter" data-level="" data-path="starting-with-data.html"><a href="starting-with-data.html#lists"><i class="fa fa-check"></i>Lists</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="conditional-statements-and-loops.html"><a href="conditional-statements-and-loops.html"><i class="fa fa-check"></i><b>7</b> Conditional Statements and Loops</a><ul>
<li class="chapter" data-level="7.1" data-path="conditional-statements-and-loops.html"><a href="conditional-statements-and-loops.html#conditional-statements"><i class="fa fa-check"></i><b>7.1</b> Conditional statements</a><ul>
<li class="chapter" data-level="" data-path="conditional-statements-and-loops.html"><a href="conditional-statements-and-loops.html#if"><i class="fa fa-check"></i>if</a></li>
<li class="chapter" data-level="" data-path="conditional-statements-and-loops.html"><a href="conditional-statements-and-loops.html#ifelse"><i class="fa fa-check"></i>if…else</a></li>
<li class="chapter" data-level="" data-path="conditional-statements-and-loops.html"><a href="conditional-statements-and-loops.html#nested-ifelse-statements"><i class="fa fa-check"></i>Nested if…else statements</a></li>
<li class="chapter" data-level="" data-path="conditional-statements-and-loops.html"><a href="conditional-statements-and-loops.html#exercise-10"><i class="fa fa-check"></i>EXERCISE</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="conditional-statements-and-loops.html"><a href="conditional-statements-and-loops.html#loops"><i class="fa fa-check"></i><b>7.2</b> Loops</a><ul>
<li class="chapter" data-level="" data-path="conditional-statements-and-loops.html"><a href="conditional-statements-and-loops.html#exercise-11"><i class="fa fa-check"></i>EXERCISE</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="manipulating-data-in-the-tidyverse.html"><a href="manipulating-data-in-the-tidyverse.html"><i class="fa fa-check"></i><b>8</b> Manipulating Data in the tidyverse</a><ul>
<li class="chapter" data-level="8.1" data-path="manipulating-data-in-the-tidyverse.html"><a href="manipulating-data-in-the-tidyverse.html#what-is-the-tidyverse"><i class="fa fa-check"></i><b>8.1</b> What is the Tidyverse</a></li>
<li class="chapter" data-level="8.2" data-path="manipulating-data-in-the-tidyverse.html"><a href="manipulating-data-in-the-tidyverse.html#tibbles"><i class="fa fa-check"></i><b>8.2</b> Tibbles</a><ul>
<li class="chapter" data-level="" data-path="manipulating-data-in-the-tidyverse.html"><a href="manipulating-data-in-the-tidyverse.html#create-a-tibble"><i class="fa fa-check"></i>Create a tibble</a></li>
<li class="chapter" data-level="" data-path="manipulating-data-in-the-tidyverse.html"><a href="manipulating-data-in-the-tidyverse.html#reading-in-tibbles"><i class="fa fa-check"></i>Reading in tibbles</a></li>
<li class="chapter" data-level="" data-path="manipulating-data-in-the-tidyverse.html"><a href="manipulating-data-in-the-tidyverse.html#exercise-12"><i class="fa fa-check"></i>EXERCISE</a></li>
<li class="chapter" data-level="" data-path="manipulating-data-in-the-tidyverse.html"><a href="manipulating-data-in-the-tidyverse.html#data-frames-versus-tibbles"><i class="fa fa-check"></i>Data frames versus tibbles</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="manipulating-data-in-the-tidyverse.html"><a href="manipulating-data-in-the-tidyverse.html#exploring-tibbles"><i class="fa fa-check"></i><b>8.3</b> Exploring tibbles</a></li>
<li class="chapter" data-level="8.4" data-path="manipulating-data-in-the-tidyverse.html"><a href="manipulating-data-in-the-tidyverse.html#tidy-data"><i class="fa fa-check"></i><b>8.4</b> Tidy data</a><ul>
<li><a href="manipulating-data-in-the-tidyverse.html#gather"><code>gather()</code></a></li>
<li><a href="manipulating-data-in-the-tidyverse.html#separate"><code>separate()</code></a></li>
<li><a href="manipulating-data-in-the-tidyverse.html#spread"><code>spread()</code></a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="manipulating-data-in-the-tidyverse.html"><a href="manipulating-data-in-the-tidyverse.html#what-is-dplyr"><i class="fa fa-check"></i><b>8.5</b> What is dplyr?</a></li>
<li class="chapter" data-level="8.6" data-path="manipulating-data-in-the-tidyverse.html"><a href="manipulating-data-in-the-tidyverse.html#selecting-columns-and-filtering-rows"><i class="fa fa-check"></i><b>8.6</b> Selecting columns and filtering rows</a><ul>
<li class="chapter" data-level="" data-path="manipulating-data-in-the-tidyverse.html"><a href="manipulating-data-in-the-tidyverse.html#exercise-13"><i class="fa fa-check"></i>EXERCISE</a></li>
</ul></li>
<li class="chapter" data-level="8.7" data-path="manipulating-data-in-the-tidyverse.html"><a href="manipulating-data-in-the-tidyverse.html#pipes"><i class="fa fa-check"></i><b>8.7</b> Pipes</a><ul>
<li class="chapter" data-level="" data-path="manipulating-data-in-the-tidyverse.html"><a href="manipulating-data-in-the-tidyverse.html#exercise-14"><i class="fa fa-check"></i>EXERCISE</a></li>
<li class="chapter" data-level="" data-path="manipulating-data-in-the-tidyverse.html"><a href="manipulating-data-in-the-tidyverse.html#exercise-15"><i class="fa fa-check"></i>EXERCISE</a></li>
</ul></li>
<li class="chapter" data-level="8.8" data-path="manipulating-data-in-the-tidyverse.html"><a href="manipulating-data-in-the-tidyverse.html#mutate"><i class="fa fa-check"></i><b>8.8</b> Mutate</a><ul>
<li class="chapter" data-level="" data-path="manipulating-data-in-the-tidyverse.html"><a href="manipulating-data-in-the-tidyverse.html#exercise-16"><i class="fa fa-check"></i>EXERCISE</a></li>
</ul></li>
<li class="chapter" data-level="8.9" data-path="manipulating-data-in-the-tidyverse.html"><a href="manipulating-data-in-the-tidyverse.html#split-apply-combine-data-analysis-and-the-summarize-function"><i class="fa fa-check"></i><b>8.9</b> Split-apply-combine data analysis and the summarize() function</a><ul>
<li class="chapter" data-level="" data-path="manipulating-data-in-the-tidyverse.html"><a href="manipulating-data-in-the-tidyverse.html#exercise-17"><i class="fa fa-check"></i>EXERCISE</a></li>
<li class="chapter" data-level="" data-path="manipulating-data-in-the-tidyverse.html"><a href="manipulating-data-in-the-tidyverse.html#exercise-18"><i class="fa fa-check"></i>EXERCISE</a></li>
</ul></li>
<li class="chapter" data-level="8.10" data-path="manipulating-data-in-the-tidyverse.html"><a href="manipulating-data-in-the-tidyverse.html#other-great-resources"><i class="fa fa-check"></i><b>8.10</b> Other great resources</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="data-visualization-with-ggplot2.html"><a href="data-visualization-with-ggplot2.html"><i class="fa fa-check"></i><b>9</b> Data Visualization with ggplot2</a><ul>
<li class="chapter" data-level="9.1" data-path="data-visualization-with-ggplot2.html"><a href="data-visualization-with-ggplot2.html#data"><i class="fa fa-check"></i><b>9.1</b> Data</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="plotting-with-ggplot2.html"><a href="plotting-with-ggplot2.html"><i class="fa fa-check"></i><b>10</b> Plotting with ggplot2</a></li>
<li class="chapter" data-level="11" data-path="building-plots-iteratively.html"><a href="building-plots-iteratively.html"><i class="fa fa-check"></i><b>11</b> Building plots iteratively</a></li>
<li class="chapter" data-level="12" data-path="faceting.html"><a href="faceting.html"><i class="fa fa-check"></i><b>12</b> Faceting</a></li>
<li class="chapter" data-level="13" data-path="barplots.html"><a href="barplots.html"><i class="fa fa-check"></i><b>13</b> Barplots</a></li>
<li class="chapter" data-level="14" data-path="histograms.html"><a href="histograms.html"><i class="fa fa-check"></i><b>14</b> Histograms</a></li>
<li class="chapter" data-level="15" data-path="boxplots.html"><a href="boxplots.html"><i class="fa fa-check"></i><b>15</b> Boxplots</a><ul>
<li class="chapter" data-level="15.0.1" data-path="boxplots.html"><a href="boxplots.html#the-five-number-summary"><i class="fa fa-check"></i><b>15.0.1</b> The Five Number Summary</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="themes.html"><a href="themes.html"><i class="fa fa-check"></i><b>16</b> Themes</a></li>
<li class="chapter" data-level="17" data-path="day-two.html"><a href="day-two.html"><i class="fa fa-check"></i><b>17</b> Day Two</a><ul>
<li class="chapter" data-level="17.1" data-path="day-two.html"><a href="day-two.html#project"><i class="fa fa-check"></i><b>17.1</b> Project</a></li>
<li class="chapter" data-level="17.2" data-path="day-two.html"><a href="day-two.html#task-1-data-import-and-examination"><i class="fa fa-check"></i><b>17.2</b> Task 1: Data import and examination</a></li>
<li class="chapter" data-level="17.3" data-path="day-two.html"><a href="day-two.html#task-2-data-tidying"><i class="fa fa-check"></i><b>17.3</b> Task 2: Data Tidying</a></li>
<li class="chapter" data-level="17.4" data-path="day-two.html"><a href="day-two.html#task-3-plots"><i class="fa fa-check"></i><b>17.4</b> Task 3: Plots</a></li>
<li class="chapter" data-level="17.5" data-path="day-two.html"><a href="day-two.html#task-4-heatmap"><i class="fa fa-check"></i><b>17.5</b> Task 4: Heatmap</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="summary.html"><a href="summary.html"><i class="fa fa-check"></i><b>18</b> Summary</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Introduction to R for Biologists</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="plotting-with-ggplot2" class="section level1">
<h1><span class="header-section-number">10</span> Plotting with ggplot2</h1>
<p>We start by loading the <code>ggplot2</code> package:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1"><span class="kw">library</span>(ggplot2)</a></code></pre></div>
<p><code>ggplot2</code> is a plotting package that makes it simple to create complex plots from data in a data frame. It provides a more programmatic interface for specifying what variables to plot, how they are displayed, and general visual properties. Therefore, we only need minimal changes if the underlying data change or if we decide to change from a bar plot to a scatter plot. This helps in creating publication quality plots with minimal amounts of adjustments and tweaking.</p>
<p><code>ggplot2</code> functions like data in the ‘long’ format, i.e., a column for every dimension, and a row for every observation. Well-structured data will save you lots of time when making figures with <code>ggplot2</code>.</p>
<p>Graphics are built step by step by adding new elements. Adding layers in this fashion allows for extensive flexibility and customization of plots.</p>
<p>To build a ggplot, we will use the following basic template that can be used for different types of plots:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1"><span class="kw">ggplot</span>(<span class="dt">data =</span> <span class="op">&lt;</span>DATA<span class="op">&gt;</span>, <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="op">&lt;</span>MAPPINGS<span class="op">&gt;</span>)) <span class="op">+</span><span class="st">  </span><span class="er">&lt;</span>GEOM_FUNCTION<span class="op">&gt;</span>()</a></code></pre></div>
<ol style="list-style-type: decimal">
<li>Specify which data set to use for the plot using the <code>data</code> argument:</li>
</ol>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1"><span class="kw">ggplot</span>(<span class="dt">data =</span> variants)</a></code></pre></div>
<ol start="2" style="list-style-type: decimal">
<li>Define a “mapping” (using the aesthetic (<code>aes</code>) function), by selecting the variables to be plotted and specifying how to present them in the graph, e.g. as x/y positions or characteristics such as size, shape, color, etc:</li>
</ol>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1"><span class="kw">ggplot</span>(<span class="dt">data =</span> variants, <span class="kw">aes</span>(<span class="dt">x =</span> POS, <span class="dt">y =</span> DP))</a></code></pre></div>
<ol start="3" style="list-style-type: decimal">
<li>Add “geoms” – graphical representations of the data in the plot (points, lines, bars). <code>ggplot2</code> offers many different geoms; we will use some common ones today, including:</li>
</ol>
<ul>
<li><code>geom_point()</code> for scatter plots, dot plots, etc.</li>
<li><code>geom_boxplot()</code> for boxplots.</li>
<li><code>geom_histogram()</code> for histograms.</li>
<li><code>geom_barplot()</code> for barplots.</li>
<li><code>geom_line()</code> for trend lines, time series, etc.</li>
</ul>
<p>To add a geom to the plot use the <code>+</code> operator. Because we have two continuous variables, let’s use <code>geom_point()</code> first:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1"><span class="kw">ggplot</span>(<span class="dt">data =</span> variants, <span class="kw">aes</span>(<span class="dt">x =</span> POS, <span class="dt">y =</span> DP)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb7-2" data-line-number="2"><span class="st">  </span><span class="kw">geom_point</span>()</a></code></pre></div>
<p><img src="IntroRWorkshop_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
<p>The <code>+</code> in the <code>ggplot2</code> package is particularly useful because it allows you to modify existing <code>ggplot</code> objects. This means you can easily set up plot templates and conveniently explore different types of plots, so the above plot can also be generated with code like this:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1"><span class="co"># Assign plot to a variable</span></a>
<a class="sourceLine" id="cb8-2" data-line-number="2">coverage_plot &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data =</span> variants, <span class="kw">aes</span>(<span class="dt">x =</span> POS, <span class="dt">y =</span> DP))</a>
<a class="sourceLine" id="cb8-3" data-line-number="3"></a>
<a class="sourceLine" id="cb8-4" data-line-number="4"><span class="co"># Draw the plot</span></a>
<a class="sourceLine" id="cb8-5" data-line-number="5">coverage_plot <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb8-6" data-line-number="6"><span class="st">    </span><span class="kw">geom_point</span>()</a></code></pre></div>
<p>Notes:</p>
<ul>
<li>Anything you put in the <code>ggplot()</code> function can be seen by any geom layers that you add (i.e., these are universal plot settings). This includes the x- and y-axis mapping you set up in <code>aes()</code>.</li>
<li>You can also specify mappings for a given geom independently of the mappings defined globally in the <code>ggplot()</code> function.</li>
<li>The <code>+</code> sign used to add new layers must be placed at the end of the line containing the previous layer. If, instead, the <code>+</code> sign is added at the beginning of the line containing the new layer, <code>ggplot2</code> will not add the new layer and will return an error message.</li>
</ul>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1"><span class="co"># This is the correct syntax for adding layers</span></a>
<a class="sourceLine" id="cb9-2" data-line-number="2">coverage_plot <span class="op">+</span></a>
<a class="sourceLine" id="cb9-3" data-line-number="3"><span class="st">  </span><span class="kw">geom_point</span>()</a>
<a class="sourceLine" id="cb9-4" data-line-number="4"></a>
<a class="sourceLine" id="cb9-5" data-line-number="5"><span class="co"># This will not add the new layer and will return an error message</span></a>
<a class="sourceLine" id="cb9-6" data-line-number="6">coverage_plot</a>
<a class="sourceLine" id="cb9-7" data-line-number="7">  <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>()</a></code></pre></div>
<div class="boxGrey">
<h2 id="principles-of-effective-display"><span class="header-section-number">10</span> Principles of effective display</h2>
<p>SOURCE: (Whitlock &amp; Schluter, The Analysis of Biological Data)[<a href="http://whitlockschluter.zoology.ubc.ca/" class="uri">http://whitlockschluter.zoology.ubc.ca/</a>]</p>
<p>We will follow these metrics to create and evaluate figures:<br />
1. Show the data<br />
2. Make patterns in the data easy to see<br />
3. Represent magnitudes honestly<br />
4. Draw graphical elements clearly, minimizing clutter</p>
</div>
<div class="box">
<h3 id="exercise-22"><span class="header-section-number">10</span> EXERCISE</h3>
<p>Create a scatter plot (using the <code>geom_point()</code> function for quality (<code>QUAL</code>) versus coverage depth (<code>DP</code>).</p>
</div>
<!-- ### SOLUTION -->
<!-- ```{r} -->
<!-- ggplot(data = variants, aes(x = QUAL, y = DP)) +  -->
<!--   geom_point() -->
<!-- ``` -->
</div>
            </section>

          </div>
        </div>
      </div>
<a href="data-visualization-with-ggplot2.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="building-plots-iteratively.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["IntroRWorkshop.pdf", "IntroRWorkshop.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
